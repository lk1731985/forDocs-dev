### VitePress 部署至 GitHub Pages 问题总结与完整教程
一、全程核心问题总结
1. Git 基础配置问题
提交代码提示「Author identity unknown」：未配置 Git 用户名 / 邮箱，无法完成代码提交；
推送被拒绝：远程 main 分支有本地未同步的代码，Git 要求先合并再推送；
SSL 证书验证失败：Windows 系统下 Git 因 SSL 证书配置问题，无法连接 GitHub 远程仓库。
2. GitHub Pages 部署冲突问题
Jekyll 构建干扰：GitHub Pages 默认触发 Jekyll 构建，与 VitePress 静态产物冲突，导致文件解析错误；
YAML 语法错误：index.md 前置元数据格式错误，触发 Jekyll 解析失败；
部署分支 / 目录不匹配：Action 监听分支（原 dev）与实际推送分支（main）不一致，部署未触发；Pages 部署源目录选错（非 gh-pages 根目录）。
3. VitePress 配置与路由问题
base 路径未配置：GitHub Pages 部署在子路径 /forDocs-dev/，VitePress 资源路径错误导致 404；
单页应用路由兼容：VitePress 默认 history 模式与 GitHub Pages 路由规则不匹配，引发 404。
4. 自动化部署 Action 问题
缺少 pnpm 环境：GitHub Actions 运行环境未预装 pnpm，导致「找不到 pnpm 命令」；
锁文件不一致：pnpm-lock.yaml 与 package.json 依赖版本不匹配，CI 环境下 frozen-lockfile 校验失败。
二、完整部署教程
1. 本地准备与 Git 基础配置
bash
# 1. 配置 Git 全局身份（首次使用必须）
git config --global user.name "你的GitHub用户名"
git config --global user.email "你的GitHub注册邮箱"

# 2. 解决 Windows 下 SSL 证书推送失败问题（临时方案）
git config --global http.sslVerify false

# 3. （可选）永久修复 SSL 证书问题（Windows）
git config --global http.sslCAinfo "C:\Program Files\Git\mingw64\ssl\certs\ca-bundle.crt"
2. VitePress 关键配置（解决 404 核心）
修改 docs/.vitepress/config.ts，确保路径与路由兼容：
typescript
import { defineConfig } from 'vitepress';

export default defineConfig({
  // 核心：与 GitHub 仓库名一致（例：仓库名 forDocs-dev，填 /forDocs-dev/）
  base: '/forDocs-dev/',  
  build: {
    outDir: './docs/.vitepress/dist' // 构建产物输出目录
  },
  // 兼容 GitHub Pages 路由规则（可选，解决单页应用 404）
  vite: {
    build: {
      target: 'es2020'
    }
  }
});
3. 创建自动化部署 Action 配置
在仓库根目录创建 .github/workflows/deploy.yml，内容如下：
yaml
name: VitePress Deploy

# 触发条件：main 分支推送 / 手动触发
on:
  push:
    branches: [main]
  workflow_dispatch:

jobs:
  deploy:
    runs-on: ubuntu-latest
    permissions:
      contents: write # 赋予写入 gh-pages 分支权限
    
    steps:
      - name: 拉取仓库代码
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: 安装 Node.js
        uses: actions/setup-node@v4
        with:
          node-version: 20

      - name: 安装 pnpm 包管理器
        run: npm install -g pnpm

      - name: 安装项目依赖（跳过锁文件校验）
        run: pnpm install --no-frozen-lockfile

      - name: 构建 VitePress 静态文件
        run: pnpm run build

      - name: 创建 .nojekyll 文件（禁用 Jekyll 构建）
        run: touch docs/.vitepress/dist/.nojekyll

      - name: 部署至 gh-pages 分支
        uses: JamesIves/github-pages-deploy-action@v4
        with:
          folder: docs/.vitepress/dist # 构建产物目录
          branch: gh-pages # 部署目标分支
          clean: true # 清理旧文件
          single-commit: true # 单个提交记录
4. 配置 GitHub Pages 部署源
打开 GitHub 仓库 → 点击顶部「Settings」（设置）；
左侧菜单栏选择「Pages」；
「Source」选择「Deploy from a branch」；
「Branch」选择「gh-pages」，目录选择「/ (root)」；
点击「Save」保存，等待部署完成。
5. 代码提交与触发部署
bash
# 1. 添加所有修改的文件
git add .

# 2. 提交代码
git commit -m "feat: 配置 VitePress 自动化部署"

# 3. 强制推送至 main 分支（覆盖远程不一致内容）
git push -f origin main
6. 访问与故障排查
（1）网站访问地址
格式：https://<你的GitHub用户名>.github.io/<仓库名>/示例：https://lk1731985.github.io/forDocs-dev/
（2）国内访问问题解决
镜像站访问：https://ghproxy.com/https://lk1731985.github.io/forDocs-dev/；
配置 Hosts / 使用加速器（如 Watt Toolkit、DevSidecar）后访问原链接。
（3）404 兜底修复
若仍提示 404，在 gh-pages 分支根目录添加 404.html，内容与 index.html 完全一致（适配单页应用路由）。
三、核心要点回顾
Git 基础：提交前必须配置用户名 / 邮箱，推送冲突优先 git pull 合并，特殊场景可强制推送（谨慎）；
部署关键：通过 .nojekyll 禁用 Jekyll、配置正确的 base 路径、部署至 gh-pages 分支；
路由兼容：VitePress 部署至静态托管平台需适配路由规则，必要时添加 404.html 回退；
自动化保障：Action 需匹配包管理器（pnpm/npm）、赋予写入权限，确保构建产物正确推送。